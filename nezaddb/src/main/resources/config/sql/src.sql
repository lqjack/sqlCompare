--ORD_FX
select /*+full(fx) parallel(16) */ 		
Fx.WSS_TID TRAN_ID,	
--Ar.AREA_FXRATEUNIT TRAN_AREA_FXRATEUNIT,						
--Ar.AREA_GL_UNIT TRAN_AREA_GL_UNIT,						
--Ar.AREA_LEADCLOSE_UNIT TRAN_AREA_LEADCLOSE_UNIT,						
Ar.AREA_UNIT TRAN_AREA_UNIT,						
Fx.APP TRAN_ASSET_CLASS,						
Fx.CCY_BOUGHT TRAN_CCY_BOUGHT,						
Fx.AMT_BOUGHT TRAN_AMT_BOUGHT,						
Fx.CCY_SOLD TRAN_CCY_SOLD,						
Fx.AMT_SOLD TRAN_AMT_SOLD,						
Fx.AMT_1 TRAN_AMTSTRNG,						
Fx.AMT_2 TRAN_AMTWEAK,						
Fx.BASE_CCY TRAN_CCY,						
Fx.BASE_EQUIV_AMOUNT TRAN_BASE_EQUIV_AMT,						
to_char(Fx.BASE_EQUIV_RATE) TRAN_BASE_EQUIV_RATE,						
Fx.BROKER_CODE TRAN_BROKER_CODE,						
Fx.CUSTOMER_REF TRAN_CUSTOMER_REF,						
Fx.DEAL_NUMBER TRAN_DEAL_NUM,						
Fx.DI_FLAG TRAN_DI_FLAG,						
Fx.DEAL_CODE TRAN_DEAL_CODE,						
Fx.ENTRY_DATE_TIME TRAN_ENTRY_DATE_TIME,						
BFx.FULLY_APP TRAN_FULLY_APP,						
Fx.WSS_GDP_TIME TRAN_GDP_TIME,						
--css.GL_AREA TRAN_GL_AREA,						
Fx.CUST_TID TRAN_CUSTID,						
Fx.EXTERN_NUM_DBEM TRAN_EXTN_DEAL_NUM,						
BFx.FSI_TID TRAN_FSI_TID,						
BFx.FSI_REC_TID TRAN_FSI_REC_TID,						
Fx.ORIG_TID TRAN_ORIG_TID,						
Fx.OTC_CODE TRAN_OTC_CODE,						
Fx.OTC_PREM TRAN_OTC_PREM,						
Fx.OTC_PREM_CCY TRAN_OTC_PREM_CCY,						
Fx.OTC_TYPE TRAN_OTC_TYPE,						
Fx.OTC_TYPE_CODE TRAN_OTC_TYPE_CODE,						
BFx.PAY_NOSTRO TRAN_PAY_NOSTRO,						
Fx.PRODUCT TRAN_PRODUCT,						
si.PAY_METH TRAN_PAY_METHOD,						
si.RECEIVE_METHOD TRAN_RECEIVE_METHOD,						
BFx.REC_NOSTRO TRAN_REC_NOSTRO,						
Fx.REMARK1 TRAN_REMARK1,						
Fx.REMARK2 TRAN_REMARK2,						
Fx.REMARK3 TRAN_REMARK3,						
to_char(Fx.RATE) TRAN_RATE,						
Fx.SPOT_DATE TRAN_SPOT_DATE,						
nvl(Fx.STATUS_FLAG, '-') TRAN_STATUS_FLAG,						
Fx.CCY_1 TRAN_CCYSTRNG,						
Fx.SWAP_SF TRAN_SWAP_SF,						
BFx.SWIFT_SETTLE_2 TRAN_SWIFT_SETTLE_2,						
Fx.TICKET_AREA TRAN_TICKET_AREA,						
Fx.TRADE_DATE TRAN_TRADE_DATE,						
Fx.TRADER TRAN_TRADER,						
--css.IBS_SITE TRAN_TRADESITE,						
Fx.TRAN_TYPE TRAN_TRAN_TYPE,						
Fx.VALUE_DATE TRAN_VALUE_DATE,						
Fx.CCY_2 TRAN_CCYWEAK,						
Fx.INVMAN_TID TRAN_DEAL_IM_TID,						
Fx.CANCEL_REASON TRAN_CANCEL_REASON,						
BFx.SWIFT_SETTLE_3 TRAN_SWIFT_SETTLE_3,						
Fx.TRADER_NAME TRAN_TRADER_NAME,						
Fx.CANCEL_DATE TRAN_CANCEL_DATE,						
FX.OTC_PREM_DD TRAN_OTC_PREM_DD,						
FX.OTC_EXO_BARR1 TRAN_OTC_EXO_BARR1,						
FX.OTC_EXO_BARR2 TRAN_OTC_EXO_BARR2,						
FX.OTC_EXO_FREE1 TRAN_OTC_EXO_FREE1,						
FX.OTC_EXO_FREE3 TRAN_OTC_EXO_FREE3,						
FX.OTC_EXO_FREE4 TRAN_OTC_EXO_FREE4,						
Fx.POINTS TRAN_POINTS,						
FX.INVMAN TRAN_INVMAN,						
FX.NDF_STCCY TRAN_NDF_STCCY,						
FX.BK_TYPE TRAN_BK_TYPE,						
--Added on 2010-03-03						
fx.BROKER_TID TRAN_BROKER_TID,						
fx.NDF_FIXDT TRAN_NDF_FIXDT,						
fx.SWAP_TID  TRAN_SWAP_TID,						
fx.NDF_ORIG_TID TRAN_NDF_ORID_TID,						
fx.INVERT TRAN_INVERT,						
fx.PORT_TID TRAN_PORT_KEY,						
fx.PUT_CCY  TRAN_PUT_CCY,						
---ADDED ON 2010-03-24						
fx.AMT_BOUGHT_EURO TRAN_AMT_BOUGHT_EURO,						
fx.AMT_SOLD_EURO TRAN_AMT_SOLD_EURO,						
fx.ARB_TID_1 TRAN_ARB_TID1,						
fx.ARB_TID_2 TRAN_ARB_TID2,						
fx.ARBITRAGE_FLAG TRAN_ARBITRAGE_FLAG,						
fx.AREA_INT_NO TRAN_AREA_INT_NO,						
fx.AVG_TO_DATE TRAN_AVG_TO_DATE,						
fx.BACK_DATED TRAN_BACK_DATED,						
fx.BREAKOUT_TID TRAN_BREAKOUT_TID,						
fx.CALL_CCY_AMOUNT TRAN_CALL_CCY_AMOUNT,						
fx.CALL_CCY TRAN_CALL_CCY_KEY_C,						
fx.CASH_ADJ TRAN_CASH_ADJ,						
fx.CCY1_TRADE_RATE TRAN_CCY1_TRADE_RATE,						
fx.CCY2_TRADE_RATE TRAN_CCY2_TRADE_RATE,						
fx.CLS_FLAG  TRAN_CLS_FLAG,						
fx.CP_AMOUNT TRAN_CP_AMOUNT,						
fx.CP_TYPE TRAN_CP_TYPE,						
fx.CUR_SPOT_REV TRAN_CUR_SPOT_REV,						
fx.CUR_SPOT_TRD TRAN_CUR_SPOT_TRD,						
fx.CUR_VAL TRAN_CUR_VAL,						
fx.CUR_VAL_DIS TRAN_CUR_VAL_DIS,						
fx.FWD_FLAG	TRAN_FWD_FLAG	,				
fx.FWD_SPOT	TRAN_FWD_SPOT	,				
fx.MAR_NPV	TRAN_MARG_NPV	,				
fx.OTC_DEL_DATE	TRAN_OTC_DEL_DATE	,				
fx.OTC_ET	TRAN_OTC_ET	,				
fx.OTC_EXC_DATE	TRAN_OTC_EXC_DATE	,				
fx.OTC_EXO_DATE1	TRAN_OTC_EXO_DATE1	,				
fx.OTC_EXO_DATE2	TRAN_OTC_EXO_DATE2	,				
fx.OTC_EXO_FREE2	TRAN_OTC_EXO_FREE2	,				
fx.OTC_EXP_TIME	TRAN_OTC_EXP_TIME	,				
fx.OTC_FDC1	TRAN_OTC_FDC1	,				
fx.OTC_FDC2	TRAN_OTC_FDC2	,				
fx.OTC_PREM_CNV	TRAN_OTC_PREM_CNV	,				
fx.OTC_PREM_NO	TRAN_OTC_PREM_NO	,				
fx.OTC_PREM_TYPE	TRAN_OTC_PREM_TYPE	,				
fx.OTC_SDC1	TRAN_OTC_SDC1	,				
fx.OTC_SDC2	TRAN_OTC_SDC2	,				
fx.OTC_SPOT_RATE	TRAN_OTC_SPOT_RATE	,				
fx.PUT_CCY_AMOUNT	TRAN_PUT_CCY_AMOUNT	,				
fx.REC_INTL	TRAN_REC_INTL	,				
fx.REUTERS_DEAL_NO	TRAN_REUTERS_DEAL_NO	,				
fx.REUTERS_NODE	TRAN_REUTERS_NODE	,				
fx.SWAP_POINTS	TRAN_SWAP_POINTS	,				
fx.TIME_OP	TRAN_TIME_OP	,				
fx.TO_ORIG_TID	TRAN_TO_ORIG_TID	,				
fx.START_DATE	TRAN_START_DATE	,				
fx.REASON TRAN_REASON,						
fx.CITY TRAN_CITY,						
fx.BROKER_COMM TRAN_COMMISSION_AMT,						
fx.INVMAN_TID TRAN_INVMAN_KEY_C,						
fx.MAR_PTS1 TRAN_MARG_PTS1,						
fx.OPTIONS_FLAG TRAN_OPTION_FLAG,						
fx.MAR_AMT1 TRAN_MARG_AMT
from GTIPDBA.FO_ORD_FX fx
inner join GTIPDBA.FO_ORD_AREA Ar on fx.area_unit = ar.area_unit
inner join GTIPDBA.ORD_CS_SITE css on ar.area_gl_unit = css.gl_unit
inner join GTIPDBA.FO_ORD_PROD prod on fx.product = prod.prod_code
left outer join gtipdba.BO_ORD_FX bfx on fx.DEAL_NUMBER = bfx.DEAL_NUMBER
left outer join GTIPDBA.BO_ORD_SI si on bfx.fsi_tid = si.wss_tid
WHERE nvl(BFX.WSS_GDP_TIME, fx.WSS_GDP_TIME) >= to_date( '2015-02-24 00:00:00', 'YYYY-MM-DD hh24:mi:ss')
and css.ibs_site = 'BOS';
